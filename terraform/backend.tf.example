# =============================================================================
# Terraform Backend Configuration - Remote State (S3 + DynamoDB)
#
# This is OPTIONAL - only needed for team collaboration.
# For single-user deployments, local state (default) is fine.
#
# To use remote state:
#   1. Create S3 bucket and DynamoDB table (see README.md)
#   2. Copy this file: cp backend.tf.example backend.tf
#   3. Update the values below with your bucket/table names
#   4. Run: terraform init -migrate-state
# =============================================================================

terraform {
  backend "s3" {
    # S3 bucket for storing state file
    bucket = "your-company-terraform-state"

    # Path within the bucket
    key = "fullbay-migration/terraform.tfstate"

    # AWS region
    region = "us-west-2"

    # Enable encryption
    encrypt = true

    # DynamoDB table for state locking
    dynamodb_table = "terraform-state-locks"

    # Workspace prefix (optional)
    # workspace_key_prefix = "workspaces"
  }
}

# =============================================================================
# To create the required resources:
# =============================================================================
#
# 1. Create S3 bucket for state:
#    aws s3 mb s3://your-company-terraform-state --region us-west-2
#    aws s3api put-bucket-versioning \
#      --bucket your-company-terraform-state \
#      --versioning-configuration Status=Enabled
#    aws s3api put-bucket-encryption \
#      --bucket your-company-terraform-state \
#      --server-side-encryption-configuration \
#      '{"Rules":[{"ApplyServerSideEncryptionByDefault":{"SSEAlgorithm":"AES256"}}]}'
#
# 2. Create DynamoDB table for locking:
#    aws dynamodb create-table \
#      --table-name terraform-state-locks \
#      --attribute-definitions AttributeName=LockID,AttributeType=S \
#      --key-schema AttributeName=LockID,KeyType=HASH \
#      --billing-mode PAY_PER_REQUEST \
#      --region us-west-2
#
# =============================================================================
